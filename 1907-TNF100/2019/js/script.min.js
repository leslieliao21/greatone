"use strict";$(function(){function _headerCallback(){console.log("%cHeader Completed",logSafeStyle),$menu=$(".menuPc"),$subMenu=$(".subMenu"),$hamburger=$(".hamburger"),$(".pageHeader"),$aboutSubMenu=$(".aboutTNF > a");var url=window.location.pathname,fileName=url.substring(url.lastIndexOf("/")+1),$chLink=$(".pageHeader a.leng").eq(0),$enLink=$(".pageHeader a.leng").eq(1),enFiles=["jiufen","orienteering","cheerpark"],temp=fileName.split(".")[0],hasEnPage=!1;if(temp=temp.split("_en")[0],$.each(enFiles,function(idx,val){temp===val&&(hasEnPage=!0)}),768<$(window).width()){var realHover=0;$(".menuPc > ul > li:not(.has-submenu)").hover(function(){$(".submenu").stop(!0,!1).slideUp(200),realHover=0}),$(".menuPc ul li.has-submenu").hover(function(){var submenuData=$(this).find("a.goSubmenu").data("submenu");$(this).siblings(".has-submenu").find(".submenu").slideUp(200),$("#"+submenuData).stop(!0,!1).slideDown(400),"TNF100"===submenuData?realHover=1:"infomation"===submenuData&&(realHover=2)},function(){1!=realHover&&2!=realHover||$(this).find(".submenu").show()}),$("body > *:not(header)").hover(function(){$(".submenu").stop(!0,!1).slideUp(200),realHover=0})}if(0<$(".enPage").length){var chFileName=fileName.split(".");chFileName[0]=chFileName[0].split("_en"),chFileName[0]=chFileName[0][0],chFileName=chFileName[0]+"."+chFileName[1],$enLink.attr("href","./2019/"+fileName),$chLink.attr("href","./2019/"+chFileName)}else{var enFileName=fileName.split(".");enFileName[0]+="_en",enFileName=enFileName[0]+"."+enFileName[1],hasEnPage?$enLink.attr("href","./2019/"+enFileName):$enLink.attr("href","./2019/"+enFiles[2]+"_en.html"),$chLink.attr("href","./2019/"+fileName)}$(".pageFooter").load("/includes/_page_footer.html",_footerCallback)}function _footerCallback(){console.log("%cFooter Completed",logSafeStyle),$footer=$(".pageFooter"),0<$(".fixedSideBar").length?$("body").hasClass("tnf100Page")?$(".fixedSideBar").load("../../includes/_fixed_side_bar_ntf100.html",_fixedSideBarCallback):$(".fixedSideBar").load("../../includes/_fixed_side_bar.html",_fixedSideBarCallback):(console.log("%cImages Start Loading...",logInfoStyle),$("html, body").imagesLoaded({background:!0}).always(mainFunction))}function mainFunction(){function hoverSubMenuOut(){$(".hoverSubMenuIn").removeClass("hoverSubMenuIn")}if(console.log("%cBuild Completed!",logSafeStyle),isNoSignUp=!!$body.hasClass("noSignUp"),isNoReview=!!$body.hasClass("noReview"),isNoSignUp&&delete fixedSidebarPos.signUp,isNoReview&&delete fixedSidebarPos.review,$win.on("resize",_resize).resize(),$win.on("scroll",_scroll).scroll(),0<$(".indexPage").length){$("._slick").slick({infinite:!0,fade:!0,autoplay:!0,autoplaySpeed:5e3,speed:SLICK_SPEED,pauseOnHover:!1,dots:!0,arrows:!1});var $kvListDots=$(".kvListDots"),$kvListDot=$(".kvListDots > div");$("._slick").on("beforeChange",function(event,slick,currentSlide,nextSlide){0===nextSlide||$kvListDots.hasClass("hide")&&$kvListDots.removeClass("hide"),$kvListDot.removeClass("selected"),$kvListDot.eq(nextSlide).addClass("selected")})}var t;if(0<$(".for2019").length&&$(".pageHeader a").each(function(){var updated_link=$(this).attr("href").replace("./","../");$(this).attr("href",updated_link)}),$(".menu > *").hover(function(){clearTimeout(t),$(this).siblings().children(".hoverSubMenuIn").removeClass("hoverSubMenuIn"),$(this).children(".subMenu").addClass("hoverSubMenuIn")},function(){t=setTimeout(hoverSubMenuOut,500)}),$(".goTop").on("click",function(evt){evt.preventDefault(),$doc.animate({scrollTop:!0},STD_DURATION)}),0<$(".indexPage").length){$kvListDot.on("click",function(){var $this=$(this),idx=$this.index();$kvListDot.removeClass("selected"),$this.addClass("selected"),$(".slick-dots > li").eq(idx+1).children().click()})}(0<$(".activetiesTemplate").length||0<$(".articlePage").length)&&($(".signUpBtn").on("click",function(){$(this).stop().slideUp(STD_DURATION).next().stop().slideDown(STD_DURATION)}),$(".formBtnWrap .cancel").on("click",function(evt){evt.preventDefault()}),lightbox.init());var targetId=location.href.split("#")[1];setTimeout(function(){$("html, body").stop().animate({scrollTop:$("#"+targetId).offset().top-headerH-60},400)},1e3),0<$(".fixedSideBar").length&&$(".fixedSideBar button").on("click",function(){var idx,gap,liIdx=$(this).parent().index();gap=3===(idx=liIdx)?4:1,$.each(fixedSidebarPos,function(key,value){value.id===idx&&$doc.animate({scrollTop:value.pos-headerH*gap},STD_DURATION)})});var b=[],c=[73,76,79,86,69,89,79,85];$win.on("keyup",function(e){b.push(e.keyCode),b.every(function(e,n){return e===c[n]})?b.length<8||$("body").append('<img class="love" src="images/background/fish.jpg">').imagesLoaded().always(function(){$(".love").addClass("start"),setTimeout(function(){$(".love").remove()},3e3)}):b.splice(0,b.length)}),$(".loading").fadeOut(STD_DURATION,function(){setTimeout(function(){$(this).remove()},STD_DURATION)})}function _resize(){winW=$win.width(),winH=$win.height(),function(){headerH=60,560<winW&&(headerH=80);768<winW&&(headerH=100)}(),footerPos=$footer.offset().top;var device=DEVICE_LINE<winW?deviceName[0]:deviceName[1];if(device===nowDeviceName)return!1;nowDeviceName=device,console.log("%cDevice is: "+nowDeviceName+"("+winW+"px)",logInfoStyle),nowDeviceName===deviceName[1]?($(".pageHeader").hasClass("en")?$(".pageHeader.en").load("/includes/_page_header_en_m.html",_headerCallback):$(".pageHeader").load("/includes/_page_header_m.html",_headerCallback),function(){for(var i=0;i<$subMenu.length;i++)subMenuH.push($subMenu.eq(i).outerHeight())}(),$(".menu > div").on("click",menuBtnHandler),$hamburger.on("click",hamburgerHandler),$body.on("click",closeMenu),$menu.on("click",function(evt){evt.stopPropagation()}),slickInit(3)):($(".pageHeader").hasClass("en")?$(".pageHeader.en").load("/includes/_page_header_en.html",_headerCallback):$(".pageHeader").load("/includes/_page_header.html",_headerCallback),$subMenu.removeAttr("style"),$(".menu > div").off("click"),$hamburger.off("click"),slickInit(4)),0<$(".fixedSideBar").length&&($.each(fixedSidebarPos,function(key){fixedSidebarPos[key].pos=$("."+key).offset().top}),console.log(fixedSidebarPos)),isFirstTime=!1}function menuBtnHandler(){var $this=$(this),$thisSubMenu=($this.index(),$this.find(".subMenu"));$this.siblings().children(".subMenu").slideUp(100,"swing"),$thisSubMenu.slideToggle(100,"swing")}function hamburgerHandler(evt){evt.stopPropagation()}function closeMenu(){}function slickInit(slideNum){if(0<$(".activetiesTemplate").length){var slickProp={slidesToShow:slideNum,slidesToScroll:slideNum,infinite:!1,autoplay:!1,speed:SLICK_SPEED,pauseOnHover:!0,dots:!1,arrows:!0,prevArrow:'<button class="slick-arrow arrow-prev inTheEnd"><div></div></>',nextArrow:'<button class="slick-arrow arrow-next"><div></div></>',variableWidth:!0};isFirstTime?$("._slick").slick(slickProp):($(".nowPage").html("1"),$("._slick").slick("unslick"),$("._slick").slick(slickProp),console.log("%cCarousel was reInit.",logErrorStyle));var slickLen=$(".slickItem").length,$slickArrow=$(".slick-arrow");$("._slick").on("afterChange",function(evt,slick,currentSlide){0===currentSlide?$(".arrow-prev").addClass("inTheEnd"):currentSlide===slickLen-slickLen%slideNum?$(".arrow-next").addClass("inTheEnd"):$slickArrow.hasClass("inTheEnd")&&$slickArrow.removeClass("inTheEnd"),$(".nowPage").html(Math.floor(currentSlide/slideNum)+1)}),$(".totalPage").html(Math.floor(slickLen/slideNum)+1)}}function _scroll(){nowPos=$win.scrollTop()+headerH+1;var scrollCounter=0;$.each(fixedSidebarPos,function(key,value){var valId=value.id;footerPos<=nowPos+winH&&0<!$(".tnf100Page").length?(isNoSignUp&&showNowPosAtFixedSidebar(4),isNoReview&&showNowPosAtFixedSidebar(3),(!isNoReview&&!isNoSignUp||!isNoSignUp&&isNoReview)&&showNowPosAtFixedSidebar(5),scrollCounter+=1):$win.scrollTop()+winH>=footerPos&&0<$(".tnf100Page").length?(showNowPosAtFixedSidebar(8),scrollCounter+=1):nowPos>=value.pos&&(showNowPosAtFixedSidebar(valId),scrollCounter+=1)}),0===scrollCounter&&removeFixedSidebarListClass(),$body.hasClass("aboutPage")&&function(nowPos){$aboutSubMenu.removeClass("selected"),footerPos+100<=nowPos+winH?$aboutSubMenu.eq(2).addClass("selected"):nowPos>=$(".js-taiwan").offset().top?$aboutSubMenu.eq(1).addClass("selected"):$aboutSubMenu.eq(0).addClass("selected")}(nowPos)}function removeFixedSidebarListClass(){$(".fixedSideBar li").removeClass("selected")}function showNowPosAtFixedSidebar(idx){removeFixedSidebarListClass(),$(".fixedSideBar li").eq(idx).addClass("selected")}var winW,winH,headerH,$footer,isNoSignUp,isNoReview,$menu,$subMenu,$hamburger,$win=$(window),$doc=$("html, body"),$body=$("body"),logSafeStyle="color: green; font-weight: bold;",logErrorStyle="color: red; font-weight: bold;",logInfoStyle="color: blue;",STD_DURATION=300,footerPos=0,fixedSidebarPos={introduction:{id:0,pos:0},course:{id:1,pos:0},origin:{id:2,pos:0},googleMap:{id:3,pos:0},review:{id:4,pos:0},signUp:{id:5,pos:0}};console.log("%cStart Build...",logInfoStyle),$(window).width()<=768?$(".pageHeader").hasClass("en")?$(".pageHeader.en").load("/includes/_page_header_en_m.html",_headerCallback):$(".pageHeader").load("/includes/_page_header_m.html",_headerCallback):$(".pageHeader").hasClass("en")?$(".pageHeader.en").load("/includes/_page_header_en.html",_headerCallback):$(".pageHeader").load("/includes/_page_header.html",_headerCallback);var subMenuH=[];$(".signUp.nthuTest").load("../includes/_signup.php",function(){var emailReg=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,mobileReg=/^09[0-9]{8}$/;$("#join_form .submit").click(function(e){e.preventDefault();var msg="",name=$("#join_form [name=name]").val(),sex=$("#join_form [name=gender]:checked").val(),pid=$("#join_form [name=pid]").val(),birthy=$("#join_form [name=birthy]").val(),birthm=$("#join_form [name=birthm]").val(),birthd=$("#join_form [name=birthd]").val(),email=$("#join_form [name=email]").val(),tel=$("#join_form [name=tel]").val(),size=$("#join_form [name=size]").val(),area_id=$("#join_form [name=area_id]").val();if(""==area_id?msg="請選擇場次":""==name?msg="請輸入姓名":0==$("#join_form [name=gender]:checked").length?msg="請選擇性別":""==pid?msg="請輸入身份證號":""==birthy||""==birthm||""==birthd?msg="請輸入出生日期":""!=email&&email.match(emailReg)?""!=tel&&tel.match(mobileReg)?""==size&&(msg="請輸入衣服尺寸"):msg="請輸入正確聯絡電話":msg="請輸入正確Email",msg)return alert(msg),!1;var data={name:name,sex:sex,pid:pid,birthy:birthy,birthm:birthm,birthd:birthd,email:email,tel:tel,size:size,area_id:area_id};$.ajax({url:"ajax/join.php",type:"get",dataType:"json",data:data,error:function(){return alert("系統忙碌中，請稍後再試"),!1},success:function(res){res.success?(alert("報名成功"),window.location.reload()):alert("報名失敗")}})}),lightbox.init()});var $aboutSubMenu,DEVICE_LINE=768,deviceName=["pc","mobile"],nowDeviceName="",SLICK_SPEED=400,isFirstTime=!0,nowPos=0});